---
title: 'Code Push for Android Hybrid Apps | Shorebird'
ogTitle: 'Code Push for Android Hybrid Apps'
description: 'Use code push in an hybrid app scenario with an Android app'
type: 'article'
url: 'https://docs.shorebird.dev/guides/hybrid-apps/android/'
---

[Skip to content](https://docs.shorebird.dev/guides/hybrid-apps/android/#_top)

# Code Push for Android Hybrid Apps

This guide explains how to use Shorebird in an Android hybrid app scenario (that is, your app embeds Flutter UI in non-Flutter UI).

## Prerequisites

This guide assumes you have already have an Android app and a Flutter module. Our Android app will be named `android_app` and our Flutter module will be named `flutter_module`.

This guide also assumes that you have created a Shorebird account. If you have not, please see our [code push guide](https://docs.shorebird.dev/code-push/initialize) for instructions.

The reference code for this guide is available at [https://github.com/shorebirdtech/samples/tree/main/add\_to\_app](https://github.com/shorebirdtech/samples/tree/main/add_to_app).

## Add Shorebird to your Flutter module

First, run `shorebird init` in your Flutter module:

```

shorebird init
```

## Create a Shorebird release

Create a Shorebird release for your Flutter module:

```

shorebird release aar --release-version 1.2.3+1
```

The `release-version` parameter needs to match the version of the Android app
that uses this module (i.e., `versionName+versionCode` from the app’s
`app/build.gradle` file).

## Update your Android app to use the `download.shorebird.dev` Maven repository

In `settings.gradle`:

```

dependencyResolutionManagement {

    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)

    repositories {

        google()

        mavenCentral()

        maven {

           // This is a relative path from this settings.gradle file to the

           // my_flutter_module/build/host/outputs/repo directory.

           url '../my_flutter_module/release'

       }

       maven {

           url 'https://storage.googleapis.com/download.flutter.io'

           url 'https://download.shorebird.dev/download.flutter.io'

      }

    }

}
```

## Update your Android app to use this version of the Flutter module

In `app/build.gradle`, add the following:

```

buildTypes {

    release {

        // ...

        // The Dart compiler builds libapp.so directly (does not use clang),and already strips

        // symbols. However when llvm-strip is run on libapp.so, the symbols are re-sorted

        // causing the hash of the library to change (which can confuse Shorebird tools).

        // This line tells gradle to skip the unnecessary llvm-strip step for libapp.so

        // thus ensuring that the libapp.so that Shorebird sees is byte-identical to the one

        // which ends up in the APK/AAR/AAB.

        packaging.jniLibs.keepDebugSymbols.add("**/libapp.so")

        // ...

    }

}

dependencies {

    // ...

    releaseImplementation 'com.example.my_flutter_module:flutter_release:1.0'

    // ...

}
```

## Verify that your app runs

In Android Studio, update the active build variant to release and run your app.
Your app should work as before with no differences.

To set the active build variant to release, click on the “Build Variants” tab in
the lower left corner of Android Studio. Then select “release” from the
“Active Build Variant” dropdown.
![Screenshot 2023-10-06 at 1 15 14 PM](https://github.com/shorebirdtech/docs/assets/581764/91b68c2c-7cee-44f1-a78a-eec443c353a3)

Attempting to build with a non-release build variant will not be able to resolve
Flutter symbols in your app.

## Submit your app to the Play Store

We won’t cover this step in detail here, but this is where you would submit your
app to the Play Store. For code push to work, it is important that you submit
_with the same `aar` generated by the release command above_.

## Verify that Shorebird is working with a patch

Make an edit to the code in your Flutter module. Then run:

```

shorebird patch aar --release-version 1.2.3+1
```

As with the `release` command, the release version should be the version of the
Android app that uses this module.

Now relaunch the app, navigate to the Flutter screen, and verify that the patch
is recognized and applied. In logcat, you should see output like the following:

```

[INFO:shorebird.cc(109)] Shorebird updater: no active patch.

[INFO:shorebird.cc(113)] Starting Shorebird update

updater::network: Sending patch check request: PatchCheckRequest { app_id: "baad0583-6810-44a7-9034-6aadb8127f29", channel: "stable", release_version: "1.0.0+8", patch_number: None, platform: "android", arch: "aarch64" }

updater::updater: Patch 1 successfully installed.

updater::updater: Update thread finished with status: Update installed
```
